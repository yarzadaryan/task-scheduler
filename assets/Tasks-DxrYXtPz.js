import{c as re,u as l,a as o,b as xe,d as me,j as t,L as he}from"./index-BtyZ8Yc9.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Q=re("plus",ue);function pe(){const f=l(e=>e.tasks),C=l(e=>e.addTask),A=l(e=>e.toggleTask),E=l(e=>e.removeTask),b=l(e=>e.presets),P=l(e=>e.addPreset),U=l(e=>e.removePreset),[M,$]=o.useState(""),[x,V]=o.useState(()=>new Date().toISOString().slice(0,10)),[m,R]=o.useState(""),[y,B]=o.useState(""),[N,v]=o.useState(""),[H,L]=o.useState(!1),{toast:h}=xe(),w=l(e=>e.todayNote),I=l(e=>e.notes),D=l(e=>e.loadNotes),O=l(e=>e.loadNoteByDate),X=l(e=>e.saveNoteForDate),Z=l(e=>e.deleteNoteById),ee=me(),[F,S]=o.useState(""),[p,te]=o.useState(()=>{const e=new Date;return e.setHours(0,0,0,0),e.getTime()});o.useEffect(()=>{D()},[D]),o.useEffect(()=>{O(p)},[p,O]),o.useEffect(()=>{S(w?.content??"")},[w]);const{todayPresets:k,otherTasks:W}=o.useMemo(()=>{const e=new Date;e.setHours(0,0,0,0);const s=e.getTime(),n=s+1440*60*1e3-1,c=a=>typeof a=="number"&&a>=s&&a<=n,d=new Set(b),i=f.filter(a=>d.has(a.title)&&c(a.dueAt??null)),r=f.filter(a=>!(d.has(a.title)&&c(a.dueAt??null)));return{todayPresets:i,otherTasks:r}},[f,b]);function se(e){const s=new Date(e);return s.setHours(0,0,0,0),s.getTime()}const K=o.useMemo(()=>{const e=[];for(let s=0;s<24;s++)for(let n=0;n<60;n+=30){const c=String(s).padStart(2,"0"),d=String(n).padStart(2,"0");e.push(`${c}:${d}`)}return e},[]),ae=o.useMemo(()=>{const e=new Map,s=se(Date.now());for(const n of b){let c=0,d=s;for(let i=0;i<365;i++){const r=d+864e5-1;if(!f.some(g=>g.title===n&&(g.dueAt??0)>=d&&(g.dueAt??0)<=r&&!!g.completedAt))break;c+=1,d-=1440*60*1e3}e.set(n,c)}return e},[f,b]),_=l(e=>e.addEvent),Y=l(e=>e.removeEvent);function u(e,s){const[n,c,d]=e.split("-").map(Number),[i,r]=s.split(":").map(Number);return new Date(n,c-1,d,i||0,r||0,0,0).getTime()}async function q(){const e=M.trim();if(!e)return;let s;if(x&&(m?s=u(x,m):s=u(x,"00:00")),await C({title:e,dueAt:s}),x&&m&&y){const n=u(x,"00:00"),c=n+1440*60*1e3,d=l.getState().events.find(a=>a.title.replace(/\s*✅$/,"")===e&&a.allDay&&a.start>=n&&a.start<c);d&&await Y(d.id);const i=u(x,m),r=Math.max(i+900*1e3,u(x,y));await _({title:e,start:i,end:r,allDay:!1})}if(H&&x){const n=u(x,"00:00");for(let c=1;c<7;c++){const d=c*7*24*60*60*1e3,i=n+d,r=new Date(i),a=r.getFullYear(),g=String(r.getMonth()+1).padStart(2,"0"),ce=String(r.getDate()).padStart(2,"0"),T=`${a}-${g}-${ce}`,de=m?u(T,m):i;if(await C({title:e,dueAt:de}),m&&y){const z=i,oe=z+1440*60*1e3,G=l.getState().events.find(j=>j.title.replace(/\s*✅$/,"")===e&&j.allDay&&j.start>=z&&j.start<oe);G&&await Y(G.id);const J=u(T,m),ie=Math.max(J+900*1e3,u(T,y));await _({title:e,start:J,end:ie,allDay:!1})}}}$(""),R(""),B(""),L(!1),h({type:"success",title:"Task added",message:e})}const le=k.filter(e=>!!e.completedAt).length,ne=k.length;return t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Tasks"}),t.jsx("p",{className:"text-sm text-black/60",children:"Daily check-ins and everything else"})]}),t.jsxs("div",{className:"rounded-full bg-black/5 text-black/70 text-xs px-3 py-1",children:["Today ",le,"/",ne]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[t.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Today's Check-ins"}),t.jsx("span",{className:"text-xs text-black/50",children:"Auto-added"})]}),t.jsxs("ul",{className:"divide-y divide-black/5",children:[k.length===0&&t.jsx("li",{className:"p-3 text-sm text-black/60",children:"No check-ins found for today"}),k.map(e=>t.jsxs("li",{className:"flex items-center justify-between p-3",children:[t.jsxs("label",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:!!e.completedAt,onChange:async()=>{await A(e.id),h({type:"success",message:e.completedAt?"Marked incomplete":"Checked in!"})},className:"h-4 w-4 rounded border-black/20 text-blue-600 focus:ring-blue-500/30"}),t.jsx("span",{className:e.completedAt?"line-through text-black/50":"",children:e.title}),t.jsxs("span",{className:"ml-2 text-xs rounded-full bg-black/5 px-2 py-0.5 text-black/70",children:[ae.get(e.title)||0,"d"]})]}),t.jsx("button",{onClick:async()=>{await E(e.id),h({type:"info",message:"Deleted"})},className:"text-xs text-red-600 hover:text-red-700",children:"Delete"})]},e.id))]})]}),t.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Presets"}),t.jsx("span",{className:"text-xs text-black/50",children:"Daily check-ins"})]}),t.jsxs("div",{className:"flex gap-2 mb-3",children:[t.jsx("input",{value:N,onChange:e=>v(e.target.value),placeholder:"Add preset (e.g., Read)",className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20",onKeyDown:e=>e.key==="Enter"&&(()=>{const s=N.trim();s&&(P(s),v(""),h({type:"success",message:"Preset added"}))})()}),t.jsxs("button",{onClick:()=>{const e=N.trim();e&&(P(e),v(""),h({type:"success",message:"Preset added"}))},className:"inline-flex items-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:[t.jsx(Q,{className:"h-4 w-4"})," Add"]})]}),t.jsxs("ul",{className:"divide-y divide-black/5",children:[b.length===0&&t.jsx("li",{className:"p-3 text-sm text-black/60",children:"No presets"}),b.map(e=>t.jsxs("li",{className:"flex items-center justify-between p-3 text-sm",children:[t.jsx("span",{children:e}),t.jsx("button",{onClick:()=>{U(e),h({type:"info",message:"Preset removed"})},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]},e))]})]})]}),t.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[t.jsx("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2 items-end",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"Task"}),t.jsx("input",{value:M,onChange:e=>$(e.target.value),placeholder:"What to do",className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20",onKeyDown:e=>e.key==="Enter"&&q()})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"Date"}),t.jsx("input",{type:"date",value:x,onChange:e=>V(e.target.value),className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"Start"}),t.jsxs("select",{value:m,onChange:e=>R(e.target.value),className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none",children:[t.jsx("option",{value:"",children:"All-day"}),K.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"End"}),t.jsxs("select",{value:y,onChange:e=>B(e.target.value),className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none",children:[t.jsx("option",{value:"",children:"—"}),K.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsx("div",{children:t.jsxs("button",{onClick:q,className:"w-full inline-flex items-center justify-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:[t.jsx(Q,{className:"h-4 w-4"})," Add"]})}),t.jsx("div",{className:"md:col-span-5",children:t.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-black/70",children:[t.jsx("input",{type:"checkbox",checked:H,onChange:e=>L(e.target.checked)})," Repeat weekly (next 6 weeks)"]})})]})}),t.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Daily Diary"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-xs text-black/50",children:["Note for ",new Date(p).toLocaleDateString()]}),t.jsx(he,{to:`/diary/${p}`,className:"text-xs underline underline-offset-4",title:"Open in Diary",children:"Open in Diary"})]})]}),t.jsx("textarea",{value:F,onChange:e=>S(e.target.value),placeholder:"How was your day? Thoughts, reflections, duas...",className:"w-full min-h-[120px] rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20"}),t.jsx("div",{className:"mt-3 flex justify-end",children:t.jsx("button",{onClick:async()=>{await X(p,F),await D(),h({type:"success",message:"Saved"})},className:"inline-flex items-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:"Save"})})]}),t.jsx("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-2 shadow-sm",children:t.jsxs("ul",{className:"divide-y divide-black/5",children:[W.length===0&&t.jsx("li",{className:"p-4 text-sm text-black/60",children:"No tasks yet"}),W.map(e=>t.jsxs("li",{className:"flex items-center justify-between p-3",children:[t.jsxs("label",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:!!e.completedAt,onChange:()=>A(e.id),className:"h-4 w-4 rounded border-black/20 text-blue-600 focus:ring-blue-500/30"}),t.jsx("span",{className:e.completedAt?"line-through text-black/50":"",children:e.title})]}),t.jsx("button",{onClick:async()=>{await E(e.id),h({type:"info",message:"Deleted"})},className:"text-xs text-red-600 hover:text-red-700",children:"Delete"})]},e.id))]})}),t.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Diary History"}),t.jsx("span",{className:"text-xs text-black/50",children:"Recent notes"})]}),t.jsxs("ul",{className:"divide-y divide-black/5",children:[I.length===0&&t.jsx("li",{className:"p-3 text-sm text-black/60",children:"No entries yet"}),I.slice().sort((e,s)=>s.date-e.date).map(e=>t.jsxs("li",{className:"p-3 flex items-center justify-between",children:[t.jsx("button",{className:`text-sm underline underline-offset-4 ${p===e.date?"font-semibold":""}`,onClick:()=>{te(e.date),ee(`/diary/${e.date}`)},children:new Date(e.date).toLocaleDateString()}),t.jsx("button",{onClick:async()=>{await Z(e.id),w?.id===e.id&&S(""),h({type:"info",message:"Deleted note"})},className:"text-xs text-red-600 hover:text-red-700",title:"Delete note",children:"Delete"})]},e.id))]})]})]})]})]})}export{pe as default};
