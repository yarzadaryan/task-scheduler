import{c as O,u as a,a as n,b as W,j as s}from"./index-BIbjcoXG.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],L=O("plus",q);function J(){const i=a(e=>e.tasks),R=a(e=>e.addTask),w=a(e=>e.toggleTask),v=a(e=>e.removeTask),o=a(e=>e.presets),D=a(e=>e.addPreset),B=a(e=>e.removePreset),[C,T]=n.useState(""),[f,y]=n.useState(""),{toast:l}=W(),S=a(e=>e.todayNote),A=a(e=>e.notes),h=a(e=>e.loadNotes),P=a(e=>e.loadNoteByDate),E=a(e=>e.saveNoteForDate),[b,j]=n.useState(""),[z,x]=n.useState(!1),[d,F]=n.useState(()=>{const e=new Date;return e.setHours(0,0,0,0),e.getTime()});n.useEffect(()=>{h()},[h]),n.useEffect(()=>{P(d)},[d,P]),n.useEffect(()=>{j(S?.content??"")},[S]);const{todayPresets:u,otherTasks:M}=n.useMemo(()=>{const e=new Date;e.setHours(0,0,0,0);const t=e.getTime(),p=t+1440*60*1e3-1,m=c=>typeof c=="number"&&c>=t&&c<=p,r=new Set(o),g=i.filter(c=>r.has(c.title)&&m(c.dueAt??null)),N=i.filter(c=>!(r.has(c.title)&&m(c.dueAt??null)));return{todayPresets:g,otherTasks:N}},[i,o]);function K(e){const t=new Date(e);return t.setHours(0,0,0,0),t.getTime()}const _=n.useMemo(()=>{const e=new Map,t=K(Date.now());for(const p of o){let m=0,r=t;for(let g=0;g<365;g++){const N=r+864e5-1;if(!i.some(k=>k.title===p&&(k.dueAt??0)>=r&&(k.dueAt??0)<=N&&!!k.completedAt))break;m+=1,r-=1440*60*1e3}e.set(p,m)}return e},[i,o]);async function H(){const e=C.trim();e&&(await R({title:e}),T(""),l({type:"success",title:"Task added",message:e}))}const $=u.filter(e=>!!e.completedAt).length,I=u.length;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex items-end justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Tasks"}),s.jsx("p",{className:"text-sm text-black/60",children:"Daily check-ins and everything else"})]}),s.jsxs("div",{className:"rounded-full bg-black/5 text-black/70 text-xs px-3 py-1",children:["Today ",$,"/",I]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Today's Check-ins"}),s.jsx("span",{className:"text-xs text-black/50",children:"Auto-added"})]}),s.jsxs("ul",{className:"divide-y divide-black/5",children:[u.length===0&&s.jsx("li",{className:"p-3 text-sm text-black/60",children:"No check-ins found for today"}),u.map(e=>s.jsxs("li",{className:"flex items-center justify-between p-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:!!e.completedAt,onChange:async()=>{await w(e.id),l({type:"success",message:e.completedAt?"Marked incomplete":"Checked in!"})},className:"h-4 w-4 rounded border-black/20 text-blue-600 focus:ring-blue-500/30"}),s.jsx("span",{className:e.completedAt?"line-through text-black/50":"",children:e.title}),s.jsxs("span",{className:"ml-2 text-xs rounded-full bg-black/5 px-2 py-0.5 text-black/70",children:[_.get(e.title)||0,"d"]})]}),s.jsx("button",{onClick:async()=>{await v(e.id),l({type:"info",message:"Deleted"})},className:"text-xs text-red-600 hover:text-red-700",children:"Delete"})]},e.id))]})]}),s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Presets"}),s.jsx("span",{className:"text-xs text-black/50",children:"Daily check-ins"})]}),s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsx("input",{value:f,onChange:e=>y(e.target.value),placeholder:"Add preset (e.g., Read)",className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20",onKeyDown:e=>e.key==="Enter"&&(()=>{const t=f.trim();t&&(D(t),y(""),l({type:"success",message:"Preset added"}))})()}),s.jsxs("button",{onClick:()=>{const e=f.trim();e&&(D(e),y(""),l({type:"success",message:"Preset added"}))},className:"inline-flex items-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:[s.jsx(L,{className:"h-4 w-4"})," Add"]})]}),s.jsxs("ul",{className:"divide-y divide-black/5",children:[o.length===0&&s.jsx("li",{className:"p-3 text-sm text-black/60",children:"No presets"}),o.map(e=>s.jsxs("li",{className:"flex items-center justify-between p-3 text-sm",children:[s.jsx("span",{children:e}),s.jsx("button",{onClick:()=>{B(e),l({type:"info",message:"Preset removed"})},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]},e))]})]})]}),s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsx("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{value:C,onChange:e=>T(e.target.value),placeholder:"Add a task",className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20",onKeyDown:e=>e.key==="Enter"&&H()}),s.jsxs("button",{onClick:H,className:"inline-flex items-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:[s.jsx(L,{className:"h-4 w-4"})," Add"]})]})}),s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Daily Diary"}),s.jsxs("span",{className:"text-xs text-black/50",children:["Note for ",new Date(d).toLocaleDateString()]})]}),s.jsx("textarea",{value:b,onChange:e=>j(e.target.value),placeholder:"How was your day? Thoughts, reflections, duas...",className:"w-full min-h-[120px] rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20"}),s.jsx("div",{className:"mt-3 flex justify-end",children:s.jsx("button",{onClick:async()=>{await E(d,b),await h(),l({type:"success",message:"Saved"})},className:"inline-flex items-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:"Save"})})]}),s.jsx("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-2 shadow-sm",children:s.jsxs("ul",{className:"divide-y divide-black/5",children:[M.length===0&&s.jsx("li",{className:"p-4 text-sm text-black/60",children:"No tasks yet"}),M.map(e=>s.jsxs("li",{className:"flex items-center justify-between p-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:!!e.completedAt,onChange:()=>w(e.id),className:"h-4 w-4 rounded border-black/20 text-blue-600 focus:ring-blue-500/30"}),s.jsx("span",{className:e.completedAt?"line-through text-black/50":"",children:e.title})]}),s.jsx("button",{onClick:async()=>{await v(e.id),l({type:"info",message:"Deleted"})},className:"text-xs text-red-600 hover:text-red-700",children:"Delete"})]},e.id))]})}),s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Diary History"}),s.jsx("span",{className:"text-xs text-black/50",children:"Recent notes"})]}),s.jsxs("ul",{className:"divide-y divide-black/5",children:[A.length===0&&s.jsx("li",{className:"p-3 text-sm text-black/60",children:"No entries yet"}),A.slice().sort((e,t)=>t.date-e.date).map(e=>s.jsx("li",{className:"p-3",children:s.jsx("button",{className:`text-sm underline underline-offset-4 ${d===e.date?"font-semibold":""}`,onClick:()=>{F(e.date),x(!0),l({type:"info",message:`Opened ${new Date(e.date).toLocaleDateString()}`})},children:new Date(e.date).toLocaleDateString()})},e.id))]})]})]})]}),z&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>x(!1)}),s.jsxs("div",{className:"relative w-[min(90vw,520px)] rounded-md shadow-2xl rotate-1 bg-yellow-100 text-black p-4 sm:p-5",children:[s.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 w-24 h-6 bg-yellow-200/70 shadow-md rotate-[-3deg]"}),s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"text-xs font-semibold tracking-wide uppercase opacity-70",children:new Date(d).toLocaleDateString()}),s.jsx("button",{onClick:()=>x(!1),className:"text-sm px-2 py-1 rounded hover:bg-black/10",children:"Close"})]}),s.jsx("textarea",{value:b,onChange:e=>j(e.target.value),className:"w-full min-h-[220px] bg-transparent outline-none resize-none text-sm leading-relaxed",placeholder:"Write your note..."}),s.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>x(!1),className:"text-sm px-3 py-1.5 rounded bg-black/10 hover:bg-black/15",children:"Cancel"}),s.jsx("button",{onClick:async()=>{await E(d,b),await h(),l({type:"success",message:"Saved"}),x(!1)},className:"text-sm px-3 py-1.5 rounded bg-black text-white hover:bg-black/90",children:"Save"})]})]})]})]})}export{J as default};
