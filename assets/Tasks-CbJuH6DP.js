import{c as Z,u as l,a as d,b as ee,d as se,j as s,L as te}from"./index-BriCUHt0.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],R=Z("plus",ae);function ne(){const b=l(e=>e.tasks),F=l(e=>e.addTask),T=l(e=>e.toggleTask),S=l(e=>e.removeTask),h=l(e=>e.presets),C=l(e=>e.addPreset),K=l(e=>e.removePreset),[A,E]=d.useState(""),[x,_]=d.useState(()=>new Date().toISOString().slice(0,10)),[p,P]=d.useState(""),[y,M]=d.useState(""),[j,N]=d.useState(""),{toast:i}=ee(),v=l(e=>e.todayNote),$=l(e=>e.notes),w=l(e=>e.loadNotes),B=l(e=>e.loadNoteByDate),W=l(e=>e.saveNoteForDate),q=l(e=>e.deleteNoteById),z=se(),[H,D]=d.useState(""),[u,G]=d.useState(()=>{const e=new Date;return e.setHours(0,0,0,0),e.getTime()});d.useEffect(()=>{w()},[w]),d.useEffect(()=>{B(u)},[u,B]),d.useEffect(()=>{D(v?.content??"")},[v]);const{todayPresets:f,otherTasks:L}=d.useMemo(()=>{const e=new Date;e.setHours(0,0,0,0);const t=e.getTime(),n=t+1440*60*1e3-1,o=a=>typeof a=="number"&&a>=t&&a<=n,c=new Set(h),r=b.filter(a=>c.has(a.title)&&o(a.dueAt??null)),m=b.filter(a=>!(c.has(a.title)&&o(a.dueAt??null)));return{todayPresets:r,otherTasks:m}},[b,h]);function J(e){const t=new Date(e);return t.setHours(0,0,0,0),t.getTime()}const I=d.useMemo(()=>{const e=[];for(let t=0;t<24;t++)for(let n=0;n<60;n+=30){const o=String(t).padStart(2,"0"),c=String(n).padStart(2,"0");e.push(`${o}:${c}`)}return e},[]),Q=d.useMemo(()=>{const e=new Map,t=J(Date.now());for(const n of h){let o=0,c=t;for(let r=0;r<365;r++){const m=c+864e5-1;if(!b.some(k=>k.title===n&&(k.dueAt??0)>=c&&(k.dueAt??0)<=m&&!!k.completedAt))break;o+=1,c-=1440*60*1e3}e.set(n,o)}return e},[b,h]),U=l(e=>e.addEvent),V=l(e=>e.removeEvent);function g(e,t){const[n,o,c]=e.split("-").map(Number),[r,m]=t.split(":").map(Number);return new Date(n,o-1,c,r||0,m||0,0,0).getTime()}async function O(){const e=A.trim();if(!e)return;let t;if(x&&(p?t=g(x,p):t=g(x,"00:00")),await F({title:e,dueAt:t}),x&&p&&y){const n=g(x,"00:00"),o=n+1440*60*1e3,c=l.getState().events.find(a=>a.title.replace(/\s*✅$/,"")===e&&a.allDay&&a.start>=n&&a.start<o);c&&await V(c.id);const r=g(x,p),m=Math.max(r+900*1e3,g(x,y));await U({title:e,start:r,end:m,allDay:!1})}E(""),P(""),M(""),i({type:"success",title:"Task added",message:e})}const X=f.filter(e=>!!e.completedAt).length,Y=f.length;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex items-end justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Tasks"}),s.jsx("p",{className:"text-sm text-black/60",children:"Daily check-ins and everything else"})]}),s.jsxs("div",{className:"rounded-full bg-black/5 text-black/70 text-xs px-3 py-1",children:["Today ",X,"/",Y]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Today's Check-ins"}),s.jsx("span",{className:"text-xs text-black/50",children:"Auto-added"})]}),s.jsxs("ul",{className:"divide-y divide-black/5",children:[f.length===0&&s.jsx("li",{className:"p-3 text-sm text-black/60",children:"No check-ins found for today"}),f.map(e=>s.jsxs("li",{className:"flex items-center justify-between p-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:!!e.completedAt,onChange:async()=>{await T(e.id),i({type:"success",message:e.completedAt?"Marked incomplete":"Checked in!"})},className:"h-4 w-4 rounded border-black/20 text-blue-600 focus:ring-blue-500/30"}),s.jsx("span",{className:e.completedAt?"line-through text-black/50":"",children:e.title}),s.jsxs("span",{className:"ml-2 text-xs rounded-full bg-black/5 px-2 py-0.5 text-black/70",children:[Q.get(e.title)||0,"d"]})]}),s.jsx("button",{onClick:async()=>{await S(e.id),i({type:"info",message:"Deleted"})},className:"text-xs text-red-600 hover:text-red-700",children:"Delete"})]},e.id))]})]}),s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Presets"}),s.jsx("span",{className:"text-xs text-black/50",children:"Daily check-ins"})]}),s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsx("input",{value:j,onChange:e=>N(e.target.value),placeholder:"Add preset (e.g., Read)",className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20",onKeyDown:e=>e.key==="Enter"&&(()=>{const t=j.trim();t&&(C(t),N(""),i({type:"success",message:"Preset added"}))})()}),s.jsxs("button",{onClick:()=>{const e=j.trim();e&&(C(e),N(""),i({type:"success",message:"Preset added"}))},className:"inline-flex items-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:[s.jsx(R,{className:"h-4 w-4"})," Add"]})]}),s.jsxs("ul",{className:"divide-y divide-black/5",children:[h.length===0&&s.jsx("li",{className:"p-3 text-sm text-black/60",children:"No presets"}),h.map(e=>s.jsxs("li",{className:"flex items-center justify-between p-3 text-sm",children:[s.jsx("span",{children:e}),s.jsx("button",{onClick:()=>{K(e),i({type:"info",message:"Preset removed"})},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]},e))]})]})]}),s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsx("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2 items-end",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"Task"}),s.jsx("input",{value:A,onChange:e=>E(e.target.value),placeholder:"What to do",className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20",onKeyDown:e=>e.key==="Enter"&&O()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"Date"}),s.jsx("input",{type:"date",value:x,onChange:e=>_(e.target.value),className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"Start"}),s.jsxs("select",{value:p,onChange:e=>P(e.target.value),className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none",children:[s.jsx("option",{value:"",children:"All-day"}),I.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-black/60 mb-1",children:"End"}),s.jsxs("select",{value:y,onChange:e=>M(e.target.value),className:"w-full rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none",children:[s.jsx("option",{value:"",children:"—"}),I.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsx("div",{children:s.jsxs("button",{onClick:O,className:"w-full inline-flex items-center justify-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:[s.jsx(R,{className:"h-4 w-4"})," Add"]})})]})}),s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Daily Diary"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("span",{className:"text-xs text-black/50",children:["Note for ",new Date(u).toLocaleDateString()]}),s.jsx(te,{to:`/diary/${u}`,className:"text-xs underline underline-offset-4",title:"Open in Diary",children:"Open in Diary"})]})]}),s.jsx("textarea",{value:H,onChange:e=>D(e.target.value),placeholder:"How was your day? Thoughts, reflections, duas...",className:"w-full min-h-[120px] rounded-xl border border-black/10 bg-white px-3 py-2 shadow-sm outline-none focus:ring-2 focus:ring-blue-500/20"}),s.jsx("div",{className:"mt-3 flex justify-end",children:s.jsx("button",{onClick:async()=>{await W(u,H),await w(),i({type:"success",message:"Saved"})},className:"inline-flex items-center gap-1 rounded-xl bg-black text-white px-4 py-2 hover:bg-black/90",children:"Save"})})]}),s.jsx("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-2 shadow-sm",children:s.jsxs("ul",{className:"divide-y divide-black/5",children:[L.length===0&&s.jsx("li",{className:"p-4 text-sm text-black/60",children:"No tasks yet"}),L.map(e=>s.jsxs("li",{className:"flex items-center justify-between p-3",children:[s.jsxs("label",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:!!e.completedAt,onChange:()=>T(e.id),className:"h-4 w-4 rounded border-black/20 text-blue-600 focus:ring-blue-500/30"}),s.jsx("span",{className:e.completedAt?"line-through text-black/50":"",children:e.title})]}),s.jsx("button",{onClick:async()=>{await S(e.id),i({type:"info",message:"Deleted"})},className:"text-xs text-red-600 hover:text-red-700",children:"Delete"})]},e.id))]})}),s.jsxs("div",{className:"rounded-2xl border border-black/5 bg-white/70 backdrop-blur p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Diary History"}),s.jsx("span",{className:"text-xs text-black/50",children:"Recent notes"})]}),s.jsxs("ul",{className:"divide-y divide-black/5",children:[$.length===0&&s.jsx("li",{className:"p-3 text-sm text-black/60",children:"No entries yet"}),$.slice().sort((e,t)=>t.date-e.date).map(e=>s.jsxs("li",{className:"p-3 flex items-center justify-between",children:[s.jsx("button",{className:`text-sm underline underline-offset-4 ${u===e.date?"font-semibold":""}`,onClick:()=>{G(e.date),z(`/diary/${e.date}`)},children:new Date(e.date).toLocaleDateString()}),s.jsx("button",{onClick:async()=>{await q(e.id),v?.id===e.id&&D(""),i({type:"info",message:"Deleted note"})},className:"text-xs text-red-600 hover:text-red-700",title:"Delete note",children:"Delete"})]},e.id))]})]})]})]})]})}export{ne as default};
